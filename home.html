<!DOCTYPE html>
<!-- Some code used from http://bl.ocks.org/nelliemckesson/5315143 -->
<htm lang="en">
<head>
  <meta charset=utf-8 />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script charset="utf-8" type="text/javascript" src="http://d3js.org/d3.v4.min.js"></script>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <title>Flying Friendly</title>
</head>
<body>
    <h1>Flying Friendly</h1>
  <div id="container"> <!--d3 chart gets inserted in this div-->
  </div>
  <image id="plane" src="theplane.png" height="700" width="500">
  <script>
  // based on this tutorial: http://mbostock.github.com/d3/tutorial/bar-1.html
  // with adjustments and stuff
  // see it here: http://jsbin.com/avemek/2/ 
  d3.csv("flying-etiquette_v2.csv", function(error, data) {
    var currentValue = 0;
    data = data.map(function(d) {
      d.recliningSeat = d["recliningSeat"];
      d.switch = d["switchFriends"];
      return d;
    });
    for (var i = 0; i < length; i++) {
      if (data[i].recliningSeat.indexOf("Yes") == 0) {
        currentValue += 1;
      }
    }
    var currentValue = (currentValue / length) * 100;
    var newData = [100, currentValue]; // here are the data values; v1 = total, v2 = current value
    var width = 100;
    var height = 500;
    var svg = d3.select("#container").append("svg") // creating the svg object inside the container div
      .attr("class", "chart")
      .attr("width", width) // bar has a fixed width
      .attr("height", height); // bar has fixed height
    /*
    var plane = d3.select("div#plane")
      .append("div")
      .classed("svg-container", true) //container class to make it responsive
      .append("svg")
      //responsive SVG needs these 2 attributes and no width and height attr
      .attr("preserveAspectRatio", "xMinYMin meet")
      .attr("viewBox", "0 0 600 400")
      //class to make it responsive
      .classed("svg-content-responsive", true); 
    */
  var x = d3.scaleLinear([0, 1])
    .range([0, width]);
  var y = d3.scaleLinear([0, 100])
    .rangeRound([0, height]);
  $("#plane").css({top: 70, left: 70, position: "absolute"}); // reposition image
    svg.selectAll("rect") // this is what actually creates the bars
    .data(newData)
    .enter().append("rect")
    .attr("width", width)
    .attr("height", function(d) { return y(d); })
    .attr("rx", 5) // rounded corners
    .attr("ry", 5)
    .attr("x", 262)
    .attr("y", 15);
  });
//   d3.csv("flying-etiquette.csv", function(error, data) {
//   if (error) throw error;
// recliningSeat

//   }
  
  /*  
  svg.selectAll("text") // adding the text labels to the bar
    .data(data)
  .enter().append("text")
    .attr("x", function(d, i) { return x(i) + (width / 2);})
    .attr("y", function(d, i) { return height - y(d) + 20;}) // y position of the text inside bar
    .attr("text-anchor", "middle") // text-align: right
    .style("fill", "black")
    .text(function(d) { return d;});
  */

  </script>

</body>
</html>